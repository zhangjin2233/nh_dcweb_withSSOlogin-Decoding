webpackJsonp([9],{"5J13":function(t,e){},yOkc:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("+SrV"),n={components:{},props:[],data:function(){var t=this;return{btns:[],iconList:i.a.iconList,currentIndex:-1,hoverIndex:-1,nodeKeyword:"",tree:new dc.Tree({hasCheckbox:!1,url:DCURL.url,params:{flag:DCURL.flag.getTree2,keyword:"",orderKey:-1},lazy:!1,key:"link",nodeClick:function(e,s,i){if("作业监控"!==s.type&&"JobFolder"!==s.type&&"PDFFolder"!==s.type){t.currentIndex=-1;for(var n=i;"Job"!==n.data.type&&0!==n.level;)n=n.parent;VUE.$router.push({query:{type:"single"+s.type,jobId:n.data.link,id:s.link}})}},initData:function(e){t.setIcon(e),this.setIcon=t.setIcon,this.defaultExpandedKeys.includes(e[0].link)||(this.defaultExpandedKeys=[e[0].link]);!function t(e){e.forEach(function(e){e.link||(e.link=e.id),e.children.length&&t(e.children)})}(e),t.loadingCount++},nodeContextmenu:function(t,e,s){this.contextmenu.showMenu(t,i.a.treeMenus[e.type.toLowerCase()])}}),keyword:"",showTree:!0,tabs:new dc.Tabs({tabs:i.a.tabs,fullscreen:!1,tabRemove:function(t){"flow"==VUE.indexTabs.from?t.currentTab="1":t.currentTab="0"}}),importantTabs:new dc.Tabs({name:"importance",tabs:[{title:"重点任务",component:"status-flow",id:"0"}],fullscreen:!1,currentTab:"0"}),showAll:!1,treeList:[],leftWidth:240,startX:0,loadingCount:0}},created:function(){var t=this;this.$reqGet(DCURL.url,{flag:DCURL.flag.getTree1}).then(function(e){e&&(t.treeList=e.CONTENT.treeList),t.loadingCount++}),this.$addListener("refreshTree",function(){t.tree.refresh()}),VUE.leftTree=this.tree,VUE.indexTabs=this.tabs,VUE.importantTabs=this.importantTabs;var e=this.$route.query.type;"Job"===e?(this.currentIndex=0,this.showAll=!0):"PDF"===e?(this.currentIndex=1,this.showAll=!0):"PDC"===e?(this.currentIndex=2,this.showAll=!0):this.$route.query.from&&(this.showAll=!0),this.$store.commit("showLoading")},destroyed:function(){this.$cancelEvent("refreshTree")},watch:{$route:function(t,e){var s=this,n=t.query.type;"PDF"===n||"Job"===n||"PDC"===n?this.tabs.tabs=i.a.tabs.slice(0,1):"singlePDF"!==n&&"singleJob"!==n||(this.tabs.tabs=i.a.tabs.slice(0,1),this.$nextTick(function(){s.tabs.tabs=i.a.tabs,1!=s.tabs.currentTab&&(s.tabs.tabs[1].component="")})),"importance"===e.query.type&&(this.tabs.currentTab="0")},showTree:function(t){var e=this;this.$nextTick(function(){e.$store.commit("updateTableWidth",t)})},leftWidth:function(t){this.$store.commit("updateTableWidth",t)},currentIndex:function(t){this.tabs.currentTab="0",this.tabs.tabs=-1===t?i.a.tabs:i.a.tabs.slice(0,1)},loadingCount:function(t){2===t&&this.$store.commit("closeLoading")},currentTab:function(t,e){1==t&&0==e?(this.tabs.tabs[this.currentTab].component||(this.tabs.tabs[this.currentTab].component="status-flow"),VUE.$emitEvent("flowRunToggle",!0)):1!=t&&(VUE.$emitEvent("flowRunToggle",!1),this.tabs.tabs[1]&&this.tabs.tabs[1].component&&VUE.$emitEvent("flowRunToggle",!1)),3!==this.tabs.tabs.length||1!=t&&0!=t||this.tabs.tabs.splice(-1,1)}},computed:{showMainTabs:function(){return"importance"!==this.$route.query.type},currentTab:function(){return this.tabs.currentTab}},methods:{itemClick:function(t,e){this.currentIndex=e,this.$router.push({query:{type:t.type}})},setIcon:function(t){var e=this;t.forEach(function(t){"Job"===t.type?t.active?t.img="/monitor/static/images/eflow_26.png":t.img="monitor/static/images/eflow_clock_gray_26.png":"PDF"===t.type?t.img="monitor/static/images/paper_box_empty_16.png":"PDFFolder"!==t.type&&"JobFolder"!==t.type||(t.img="monitor/static/images/folder_16.png"),t.children&&t.children.length>0&&e.setIcon(t.children)})},back:function(){var t=this.$route.query.from,e={type:t,hisOpTime:this.$store.state.hisOpTime||this.$store.state.opTime};"singleJob"===t&&(e.jobId=this.$route.query.jobId,e.id=this.$route.query.jobId,this.$route.query.single||(e.from="Job")),this.$router.push({path:"/list",query:e}),"1"==this.tabs.currentTab&&(VUE.$emitEvent("flowRunToggle",!1),this.tabs.currentTab="0")},getTreeNodes:function(t){for(var e=[],s=0;s<t.length;s++){var i=t[s];e.push({id:i.id,value:i.label}),i.children.length>0&&(e=e.concat(this.getTreeNodes(i.children)))}return e},handleSelect:function(t){var e=t.id;this.tree.setCurrentKey(e,!0)},dragLine:function(t,e){"start"===t?this.startX=e.screenX:this.leftWidth+=e.screenX-this.startX},getSearch:function(t){var e=this;"PDC"===t?this.$openDialog(new dc.Dialog({title:"搜索作业",component:"searchDialog",width:"700px",data:{tree:this.tree,data:[],keyword:"",flag:t}})):this.$reqGet(DCURL.url,{flag:"搜索"+t,keyword:this.keyword,pageNo:1,pageSize:25},{},!0).then(function(t){if(t){var s=t.CONTENT.ids;s.length>0?s.forEach(function(t,s){e.tree.setCurrentKey(t,0===s)}):e.tree.selectNodes=[]}})}}},r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"list"},[t.showTree?s("div",{staticClass:"border",style:"left:"+t.leftWidth+"px",attrs:{draggable:"true"},on:{dragstart:function(e){t.dragLine("start",e)},dragend:function(e){t.dragLine("end",e)}}}):t._e(),t._v(" "),s("transition",{attrs:{name:"fade"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.showTree,expression:"showTree"}],staticClass:"left",style:"width:"+t.leftWidth+"px"},[s("div",{staticClass:"exchange",style:"left: "+(t.leftWidth-34)+"px",attrs:{title:"切换查看界面"}},[s("i",{staticClass:"fa fa-exchange",attrs:{title:"切换查看方式"},on:{click:function(e){t.showAll=!t.showAll}}})]),t._v(" "),s("el-input",{directives:[{name:"show",rawName:"v-show",value:!t.showAll,expression:"!showAll"}],staticStyle:{width:"150px"},attrs:{size:"mini",placeholder:"输入关键字搜索"},nativeOn:{keypress:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.getSearch("Job和PDF")}},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}),t._v(" "),s("el-button-group",{directives:[{name:"show",rawName:"v-show",value:!t.showAll,expression:"!showAll"}]},[s("el-button",{staticClass:"search-btn",attrs:{type:"primary",size:"mini",icon:"el-icon-search",title:"搜索调度流/调度"},on:{click:function(e){t.getSearch("Job和PDF")}}}),t._v(" "),s("el-button",{staticClass:"search-btn",attrs:{type:"primary",size:"mini",title:"搜索作业"},on:{click:function(e){t.getSearch("PDC")}}},[s("i",{staticClass:"search-pdc"})])],1),t._v(" "),s("div",{staticClass:"tree-wrapper"},[s("dc-tree",{directives:[{name:"show",rawName:"v-show",value:!t.showAll,expression:"!showAll"}],attrs:{object:t.tree}}),t._v(" "),t.showAll?s("ul",{staticClass:"tree-list"},t._l(t.treeList,function(e,i){return s("li",{key:i,class:{"item-active":t.currentIndex==i},on:{click:function(s){t.itemClick(e,i)}}},[s("img",{attrs:{src:t.iconList[i],alt:""}}),t._v("\n                        "+t._s(e.label)+"\n                    ")])})):t._e()],1)],1)]),t._v(" "),t.$route.query.type?s("div",{staticClass:"right",class:{"hide-left":!t.showTree},style:"left: "+(t.leftWidth+11)+"px; width: scal(100% -"+(t.leftWidth+10)+"px)"},[t.showMainTabs?s("dc-tabs",{attrs:{object:t.tabs}}):s("dc-tabs",{attrs:{object:t.importantTabs}}),t._v(" "),t.$route.query.from?s("div",{staticClass:"back"},[s("el-button",{staticClass:"fa fa-chevron-left",attrs:{title:"返回上一页",size:"mini"},on:{click:t.back}})],1):t._e()],1):t._e()],1)},staticRenderFns:[]};var a=s("VU/8")(n,r,!1,function(t){s("5J13")},"data-v-6b041cf4",null);e.default=a.exports}});